function recommendFriends(){$.ajax({type:"post",cache:false,url:"recommendFriendsByJs_ajax.html",timeout:20000,data:{},dataType:"json",success:function(d){$("#loadingPic").hide();$("#randomRecommendUser").show();var b="";var c=d.length;if(c>4){c=4}for(var a=0;a<c;a++){if(d[a].scholarField==null){d[a].scholarField=""}b+="<li><div class='s_card' style='border-bottom:1px solid #ECECEC; height:96px;padding-left:5px;'><div class='p_scholar'><a  href='"+d[a].username+"' target='_blank'><c:if test='${not empty "+d[a].pictureUrl+" }'><img class='mp_img' onerror='this.src=\"./images/default.png\"' src='./"+d[a].pictureUrl+"'></c:if></a></div><div class='p_scholar_right'><a class='s_name' href='"+d[a].username+"' target='_blank'>"+d[a].chineseName+"</a><img src='./images/homepage/addfriend.jpg' style='height: 24px;padding-left: 10px;padding-bottom: 5px;' onclick='javascript:popupDivOut(\"reqMessage\","+d[a].userId+",\"${pageContext.request.remoteUser}\")'><div class='mp_name' >"+d[a].workUnit+"</div><div class='mp_name' >"+d[a].scholarField+"</div></div></div></li>"}$("#randomRecommend").append(b)},error:function(){}})}function getLatestVisitors(){$.ajax({type:"post",cache:false,url:"getLatestVisitors.html",timeout:20000,data:{},dataType:"json",success:function(d){var b="";var c=d[0].length;if(c>9){c=9}else{if(c<1){return}}for(var a=0;a<c;a++){b=b+"<li title='"+d[0][a].chineseName+"'><a class='userpic' href='"+d[0][a].username+"' target='_blank'><img style='border: 1px solid #ddd' onerror=\"this.src='images/default.png'\" src=\""+d[0][a].pictureUrl+"\"></a><p style=\"font-family:'Georgia', Georgia, 'Times New Roman', Times, 'Microsoft YaHei', SimSun, SimHei, serif; 'Georgia', Georgia, 'Times New Roman', Times, 'Microsoft YaHei', SimSun, SimHei, serif; height: 15px; line-height: 15px; display: block; width: 40px; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\"><a href=\""+d[0][a].username+'" target="_blank">'+d[0][a].chineseName+'</a></p><p class="rdate">'+d[0][a].date+"</p></li>"}$("#latestVistors").append(b);b='<div style="height: 25px; padding-bottom: 16px;"><a style="float: right; font-size: 14px; position: position; margin-right: 16px; color: #399; padding: 5px 4px 0;">Visits:&nbsp; '+d[1]+" </a></div>";$("#divVistors").append(b).show()},error:function(){}})}function strJsonToJsonByEval(jsonData){var json=eval("("+jsonData+")");return json}function myalert(a){var b="m"+a;var d=document.getElementById(b);var c=d.value;c=c.replace(/\+/g,"%2b");window.location.href=c}var loadCourseRemind=function(){$.ajax({type:"post",url:"calendarCourse-getTodayCourse_ajax.html",dataType:"json",cache:false,timeout:10000,success:function(a){if(a>0){$(".noRemind").hide();$(".courseRemind").show()}}})};$(document).ready(function(){$(".edit").hover(function(){$(this).find(".editUp").stop().animate({height:"34px"},400);$(this).find(".editUp p").stop().animate({paddingTop:"7px"},400)},function(){$(this).find(".editUp").stop().animate({height:"0px"},400);$(this).find(".editUp p").stop().animate({paddingTop:"0px"},400)});loadCourseRemind()});$(document).ready(function(){$(".pm_").mouseover(function(){$(".pm_").css("background-color","#FF9C85")});$(".pm_").mouseout(function(){$(".pm_").css("background-color","#F38258")})});$(document).ready(function(){$(".cm_").mouseover(function(){$(".cm_").css("background-color","#2ac1c0")});$(".cm_").mouseout(function(){$(".cm_").css("background-color","#399")})});$(document).ready(function(){$(".inviteFr").mouseover(function(){$(".inviteFr").css("background-color","#2ac1c0")});$(".inviteFr").mouseout(function(){$(".inviteFr").css("background-color","#399")})});$("#add_cal_in").click(function(){newEvent(new Date(),_end,_allday)});$(document).ready(function(){FreshEventNews.getFreshEventNewsByJs_page()});var isLatestShow=false;var isMomentShow=false;var preAddFriend="";var spanId=0;var firstIn=false;var FreshEventNews={freshEventTeamBegin:0,freshEventCourseBegin:0,freshEventDynamicBegin:0,preTeamName:"",preCourseName:"",preTeamProfileName:"",preCourseProfileName:"",preDynamicProfileName:"",isNoFreshEvent:true,getFreshEventNewsByJs_page:function(){$("#moreEvents").remove();$("#freshEventNews").append("<img id='freshEventLoadingPic' src='./images/space/loading.gif' style='margin-top:10px;position:absolute;left:38%;' />");$.ajax({type:"post",cache:false,url:"getFreshEventByJs_Page.html",data:{freshEventDynamicBegin:FreshEventNews.freshEventDynamicBegin,freshEventTeamBegin:FreshEventNews.freshEventTeamBegin,freshEventCourseBegin:FreshEventNews.freshEventCourseBegin},dataType:"json",success:function(a){if(a[0].messagetitle=="该用户没有好友"&&isLatestShow==false&&isMomentShow==false){FreshEventNews.appendLatestNewActives_Page(a);document.getElementById("latestNewContent").style.display="block";isLatestShow=true}else{FreshEventNews.appendFreshEventsNews(a);document.getElementById("momentContent").style.display="block";isMomentShow=true}isFreshEventLoading=false},error:function(){isFreshEventLoading=false}})},appendFreshEventsNews:function(b){FreshEventNews.isNoFreshEvent=false;$("#freshEventLoadingPic").remove();for(var a=0;a<b.length;++a){if(b[a].dynamicType==0){++FreshEventNews.freshEventDynamicBegin;FreshEventNews.appendFreshEventsDynamic(b[a])}else{if(b[a].dynamicType==1){++FreshEventNews.freshEventTeamBegin;FreshEventNews.appendFreshEventsTeam(b[a])}else{if(b[a].dynamicType!=undefined){++FreshEventNews.freshEventCourseBegin;FreshEventNews.appendFreshEventsCourse(b[a])}}}if(firstIn==true&&a==b.length-1){FreshEventNews.getFreshEventNewsByJs_page()}}if(firstIn==false){var c="<ul onclick='javascript:FreshEventNews.getFreshEventNewsByJs_page()' id = 'moreEvents'><img id='friendloadingPic' src='./images/space/getmoreinfo.png' style='margin-bottom:3px;'/>&nbsp;&nbsp;加载更多</ul>";$("#freshEventNews").append(c)}firstIn=false},appendFreshEventsDynamic:function(d){var m="";var i="";var j="";var f=d.actionType;var g=d.contentTitle;if(d.profilePictureUrl!=null&&d.profilePictureUrl!=""){i=d.profilePictureUrl}else{i="images/default.png"}switch(f){case"0":f="发布动态";g="<a style='font-size:14px;color:#399;' href='./vpost.html?pid="+g+"</a>";break;case"1":f="更新简介";g="";break;case"2":f="更新论文";g="<a style='font-size:14px;color:#399;' href='./portalPaperInfo.html?paperID="+d.typeId+"&Entry="+d.profileUsername+"'>"+g+"</a>";break;case"3":f="与";var h=d.contentTitle+"|"+d.profileUsername+","+d.profileChineseName;if(h==preAddFriend){return}m=g.split(",");g="<a style='font-size:14px;color:#399;' href=./"+m[0]+" target=_blank>"+m[1]+"</a>&nbsp;<font color=#777><addfriend></font>";preAddFriend=d.profileUsername+","+d.profileChineseName+"|"+d.contentTitle;break;case"4":f="加入团队";m=g.split(",");g="<a style='font-size:14px;color:#399;' title='"+m[1]+"' class='from' style='text-decoration: none;' href='./teamIndex.html?teamId="+m[0]+"' target='_blank'>"+m[1]+"</a>";break;case"5":f="更换主页模版";g="";break;case"6":f="上传新头像";g="";break;case"7":f="更新项目";break;case"10":f="更新著作";break;case"11":f="更新知识产权";break;case"12":if(isNaN(d.reprintorUser)){f="转载 <a class='from' href='./"+d.reprintorUser+"' target='_blank' style='font-size: 14px;color: #399'>"+d.reprintorUserName+"</a> 的动态"}else{f="转载 <a class='from' href='./teamIndex.html?teamId="+d.reprintorUser+"' target='_blank' style='font-size: 14px;color: #399' >"+d.reprintorUserName+"</a> 的团队动态"}g=g.replace("target=_blank>[转]","target=_blank");g="<a style='font-size:14px;color:#399;' target='_blank' title='"+g+"' href=./vpost.html?pid="+d.typeId+">"+g+"</a>";break;case"100":f="分享课程";g="<a style='font-size:14px;color:#399;' href='./"+d.tmp+"' target='_blank' title='"+g+"'>"+g+"</a>";break;case"13":f="分享团队";g="<a style='font-size:14px;color:#399;' href='./"+d.tmp+"' target='_blank' title='"+g+"'>"+g+"</a>";break;case"15":f="推荐学者";g="<a style='font-size:14px;color:#399;' href='http://www.scholat.com/"+d.tmp+"' target='_blank' title='"+g+"'>"+g+"</a>";break;default:f="更新其他信息";break}var c="互为好友";var n="";if(d.actionType!="3"){c=""}else{var m=d.contentTitle.split(",");n=m[1]}if(FreshEventNews.preDynamicProfileName==d.profileChineseName||(FreshEventNews.preDynamicProfileName==n&&d.actionType=="3")){if(d.actionType=="3"){if(FreshEventNews.preDynamicProfileName==n){g="<a style='font-size:14px;color:#399;' href=./"+d.profileUsername+" target=_blank>"+d.profileChineseName+"</a>&nbsp;<font color=#777><addfriend></font>";d.profileChineseName=n}var b=spanId-1;var a=document.getElementById("sp_"+b);if(a==null){a=document.getElementById("sp_"+(b-1))}if(a!=null&&a.innerHTML.indexOf("<addfriend>")>0){var l=a.innerHTML.split("</a>");var k=a.innerHTML;k=k.replace(/&nbsp;&nbsp;<etal>等用户<\/etal>/g,"");var e=document.getElementById("sp_"+b);if(e==null){e=document.getElementById("sp_"+(b-1))}if(l.length%9==0){e.innerHTML=k+"<font color='#777'>，</font><br><span style='visibility:hidden;'><font>┃┃&nbsp;&nbsp;</font><font>与&nbsp;&nbsp;</font></span>"+g+"<font color='#777'>&nbsp;&nbsp;<etal>等用户</etal></font>"}else{e.innerHTML=k+"<font color='#777'>，</font>"+g+"<font color='#777'>&nbsp;&nbsp;<etal>等用户</etal></font>"}if(l.length>4){firstIn=true}}else{j="<div class='sameFreshEventNewsStyle' ><p class=action style='padding-left:78px;padding-right:10px;font-size:14px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><font style='color:#777'>"+f+"&nbsp;</font><span id=sp_"+spanId+" class=content style='font-size:14px;'> "+g+"</span><font color='#777'>"+c+"</font></p><p class=time style='padding-left:80px'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</p></div>";spanId++}}else{j="<div class='sameFreshEventNewsStyle'><p class=action style='padding-left:78px;padding-right:10px;font-size:14px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><font style='color:#777'>"+f+"&nbsp;</font><span id=sp_"+spanId+" class=content style='font-size:14px;'> "+g+"</span><font color='#777'>"+c+"</font></p><p class=time style='padding-left:80px'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</p></div>";spanId++}}else{j="<div class='freshEventsNewsStyle'><a target=_blank href=./"+d.profileUsername+"><img style='margin-top:8px;margin-left:8px;' onerror=\"this.src='./images/default.png'\" class=user_img src=./"+i+" /></a><p class=info style='width:572px;*height:71px;*width:500px;'><a style='color:#399;text-decoration: none;font-size:15px;' href=./"+d.profileUsername+" target=_blank>"+d.profileChineseName+"</a>&nbsp;&nbsp;&nbsp;&nbsp;<span class=title>"+d.profileWorkUnit+"</span></p><p class=action style='padding-left:78px;padding-right:12px;font-size:14px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><font style='color:#777'>"+f+"&nbsp;</font><span id=sp_"+spanId+" class=content style='font-size:14px;'> "+g+"</span><font color='#777'>"+c+"</font></p><p class=time style='padding-left:80px'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</p></div>";spanId++}FreshEventNews.preTeamName="";FreshEventNews.preCourseName="";FreshEventNews.preDynamicProfileName=d.profileChineseName;$("#freshEventNews").append(j)},appendFreshEventsTeam:function(d){var a="";var c="";var b="";if(d.teamPictureUrl!=null&&d.teamPictureUrl!=""){c=d.teamPictureUrl}else{c="./teamwork/img/teamdefault.png"}if(d.actionType=="推送动态"){a="<a title='"+d.contentTitle+"' style='color: #399;' href=./vpost.html?"+d.tmp+" target=_blank><span class=content style='font-size:14px;'>"+d.contentTitle+"</span></a>"}else{if(d.actionType=="发布动态"){a="<a title='"+d.contentTitle+"' style='color: #399;' href=./teamwork/showPostMessage.html?"+d.tmp+" target=_blank><span class=content style='font-size:14px;'>"+d.contentTitle+"</span></a>"}else{if(d.actionType=="上传资源"){a="<a title='"+d.contentTitle+"' style='color: #399;' href=./teamworkdownloadscholar.html?"+d.tmp+"><span class=content style='font-size:14px;'>"+d.contentTitle+"</span></a>"}else{a="<a title='"+d.contentTitle+"' style='color: #399;' href=./teamIndex.html?"+d.tmp+" target=_blank></a>"}}}if(FreshEventNews.preTeamName==d.teamName){if(FreshEventNews.preTeamProfileName==d.profileUsername){b="<div class='sameFreshEventNewsStyle'><p class=action style='style='padding-left:78px;padding-right:12px;font-size:14px;''><font style='color:#399'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+d.actionType+"</font>&nbsp;<span class=content>"+a+"</span></p><p class=time style='overflow: hidden;text-overflow: ellipsis;white-space: nowrap;text-align: left;width: 460px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</span></p></div>"}else{b="<div class='sameFreshEventNewsStyle'><p style='padding-left:78px;padding-right:12px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><a style='color:#399;text-decoration: none;font-size:15px;' href=./"+d.profileUsername+" target=_blank>"+d.profileChineseName+"</a>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=title>"+d.profileWorkUnit+"&nbsp;</span></p><p class=action style='padding-left:78px;padding-right:12px;font-size:14px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+d.actionType+"</font>&nbsp;<span class=content>"+a+"</span></p><p class=time style='overflow: hidden;text-overflow: ellipsis;white-space: nowrap;text-align: left;width: 460px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</span></p></div>"}}else{b="<div class='freshEventsNewsStyle'><a target=_blank href=./"+d.teamUrlPara+"><img style='margin-top:8px;margin-left:8px;' onerror=\"this.src='./teamwork/img/teamdefault.png'\" class=user_img src=./"+c+" /></a><p class=info style='width:572px;*height:71px;*width:500px;'><a style='color:#399;text-decoration: none;font-size:15px;' title="+d.teamName+" href=./"+d.teamUrlPara+" target=_blank>"+d.teamName+"&nbsp;</a></p><p style='padding-left:78px;padding-right:12px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><a style='color:#399;text-decoration: none;font-size:15px;' href=./"+d.profileUsername+" target=_blank>"+d.profileChineseName+"</a>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=title>"+d.profileWorkUnit+"&nbsp;</span></p><p class=action style='padding-left:78px;padding-right:12px;font-size:14px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+d.actionType+"</font>&nbsp;<span class=content style='font-size:15px;'> "+a+"</span></p><p class=time style='overflow: hidden;text-overflow: ellipsis;white-space: nowrap;text-align: left;width: 460px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+d.strDate+"</span></p></div>"}FreshEventNews.preCourseName="";FreshEventNews.preDynamicProfileName="";FreshEventNews.preTeamName=d.teamName;FreshEventNews.preTeamProfileName=d.profileUsername;$("#freshEventNews").append(b)},appendFreshEventsCourse:function(b){var a="";if(FreshEventNews.preCourseName==b.courseName){if(FreshEventNews.preCourseProfileName==b.profileChineseName){a="<div class='sameFreshEventNewsStyle'><p class=action style='padding-left:78px;padding-right:12px;font-size:14px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+b.actionType+"</font>&nbsp;<span class=content><a style='font-size:14px;color:#399' href='"+b.tmp+"' target='_blank' title='"+b.contentTitle+"'>"+b.contentTitle+"</a></span></p><p class=time style='overflow: hidden;text-overflow: ellipsis;white-space: nowrap;text-align: left;width: 460px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+b.strDate+"</span></p></div>"}else{a="<div class='sameFreshEventNewsStyle'><p style='padding-left:68px;padding-right:12px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><a style='color:#399;text-decoration: none;font-size:15px;' href=./"+b.profileUsername+" target=_blank>"+b.profileChineseName+"</a>&nbsp;&nbsp;&nbsp;&nbsp;<span style='font-size:15px;'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=title>"+b.profileWorkUnit+"&nbsp;</span></p><p class=action style='padding-left:78px;padding-right:12px;font-size:14px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+b.actionType+"</font>&nbsp;<span class=content><a style='font-size:14px;color:#399' href='"+b.temp+"' target='_blank' title='"+b.contentTitle+"'>"+b.contentTitle+"</a></span></p><p class=time style='overflow: hidden;text-overflow: ellipsis;white-space: nowrap;text-align: left;width: 460px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+b.strDate+"</span></p></div>"}}else{a="<div class='freshEventsNewsStyle'><a target=_blank href=./"+b.courseUrlPara+"><img style='margin-top:8px;margin-left:8px;' onerror=\"this.src='http://www.scholat.com/course/images/courseDefault2.jpg'\" class=user_img src=./"+b.coursePictureUrl+" /></a><p class=info style='width:572px;*height:71px;*width:500px;'><a style='text-decoration:none;font-size:15px;' title="+b.courseName+" href=' "+b.courseUrlPara+"' target='_blank'>"+b.courseName+"&nbsp;</a></p><p style='padding-left:78px;padding-right:12px;'><font style='color:#399'>┃┃&nbsp;&nbsp;</font><a style='text-decoration:none;font-size:15px;' href='"+b.profileUsername+"' target='_blank'>"+b.profileChineseName+"</a>&nbsp;&nbsp;&nbsp;&nbsp;<span class='title'>"+b.profileWorkUnit+"&nbsp;</span></p><p class='action'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font><font style='color: #777'>"+b.actionType+"</font>&nbsp;<a style='font-size:14px;color:#399' href='"+b.tmp+"' target='_blank' title='"+b.contentTitle+"'>"+b.contentTitle+"</a></p><p class='time' style='padding-left:80px;'><font style='color:#fff'>┃┃&nbsp;&nbsp;</font>"+b.strDate+"</p></div>"}FreshEventNews.preTeamName="";FreshEventNews.preDynamicProfileName="";FreshEventNews.preCourseName=b.courseName;FreshEventNews.preCourseProfileName=b.profileChineseName;$("#freshEventNews").append(a)},appendLatestNewActives_Page:function(c){var b="";for(var a=1;a<c.length;++a){if(c[a].title==undefined){c[a].title=""}b+="<div class='freshEventsNewsStyle'><a target=_blank href=./"+c[a].username+"><img style='margin-left:8px;margin-top:8px;float:left;' onerror=\"this.src='./images/default.png'\" class=user_img src=./"+c[a].picture_url+" /></a><p class=info style='width:572px;*height:71px;*width:500px;'><a style='text-decoration: none;font-size:14px;' href=./"+c[a].username+" target=_blank>"+c[a].chineseName+"</a><br/><span class=title>"+c[a].workunit+"&emsp;"+c[a].title+"</span></p><p class=action style='padding-left:78px;padding-right:12px;'>发布动态：<a style='color:#399;font-size:14px;' target=_blank href='./vpost.html?pid="+c[a].ID+"'>"+c[a].messagetitle+"</a></p><p class=time style='padding-left:80px;'>"+c[a].createDate+"</p></div>"}$("#latestNewActives").append(b)}};var isFreshEventLoading=false;var timestamp=(new Date()).valueOf();$(window).scroll(function(){var b=$(this).scrollTop();var a=$(document).height();var d=$(this).height();if(b+d>a-600&&isFreshEventLoading==false&&FreshEventNews.isNoFreshEvent==false){var c=(new Date()).valueOf()-timestamp;isFreshEventLoading=true;if(c>1000){timestamp=(new Date()).valueOf();setTimeout(function(){FreshEventNews.getFreshEventNewsByJs_page()},400)}else{isFreshEventLoading=false}}});function Requestforaddfriend(c){var b=$("#receiverID").val();var a=$("#message").val();if(confirm("确定加为好友？")){$.ajax({type:"post",url:"Requestforaddfriend.html",timeout:60000,data:{receiverID:b,username:c,reqMessage:a},dataType:"text",cache:false,success:function(d){if(d=="you are friends"){window.alert("您们已经是朋友了！")}else{if(d=="you had send a request"){window.alert("您已经发送过申请！请等待好友答复！")}else{if(d=="yourself"){window.alert("不能添加自己或管理员为好友！")}else{window.alert("申请已发，请等待好友答复！")}}}hideDiv("reqMessage")}})}}function popupDivOut(d,c,b){var a=$(window).scrollTop();var f=$(window).height()/2-200+a;var e=$(window).width()/2-150;$("#"+d).animate({opacity:"show",left:e,top:f,width:300,height:180},300);$("#receiverID").val(c)}function hideDiv(a){$("#"+a).animate({opacity:"hide"},300)};